import {
  CorpusInput,
  //ImportApprovedCuratedCorpusItemMutationResponse,
} from '../types';
import config from '../config';
import fetch from 'node-fetch';

/**
 * Call the importApprovedCuratedCorpusItem mutation
 * @param data input variables for the mutation. Of the type CorpusInput
 * @returns json response of type ImportApprovedCuratedCorpusItemMutationResponse
 */
export async function importApprovedCuratedCorpusItem(data: CorpusInput) {
  const mutation = `
  mutation importApprovedItem($data: ImportApprovedCuratedCorpusItemInput!) {
    importApprovedCuratedCorpusItem(data: $data) {
      approvedItem {
        externalId
      }
      scheduledItem {
        externalId
        scheduledSurfaceGuid
      }
    }
  }
`;

  const variables = { data };
  const res = await fetch(config.AdminApi, {
    method: 'post',
    headers: {
      'Content-Type': 'application/json',
      //TODO: what's the plan with the auth token?
      Authorization:
        'Bearer eyJraWQiOiJremU0TTBDaVhvRE83UWtwaWcxb0gwRjZPSW56Wmc2dWdrMFB5b2pPbHpjPSIsImFsZyI6IlJTMjU2In0.eyJhdF9oYXNoIjoiOVBBTzFkTS1jOE52WTBVblo4ZWs3USIsInN1YiI6IjZlOTgzMTFiLWNjZDgtNDIxYy05YTQ0LTZmNzAwZDVhZmQyMSIsImNvZ25pdG86Z3JvdXBzIjpbInVzLWVhc3QtMV8xYWxLbHM0cXdfQXV0aDAiXSwiZW1haWxfdmVyaWZpZWQiOnRydWUsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xXzFhbEtsczRxdyIsImNvZ25pdG86dXNlcm5hbWUiOiJBdXRoMF9hZHxNb3ppbGxhLUxEQVB8aGx1aGFubyIsImdpdmVuX25hbWUiOiJIZXJyYWoiLCJub25jZSI6IjAzTTNTVlhjLXBwTXJ4Z1hsdS1KdkxsSU83VVhMd0hnN1B2MXVKNWtYMDZpbDZGUlFZX2syZkFXU293ZVZHXzNBdlFLWndGZHVzS2FqZHpWUzhDV3JWcmNzNUZ6bjNjZVQ2X1gwcVJyR1dGalV2Y0VBQ19IZjNTUHBrU2RoNTFVd09PY09nVDM2VjZfZ0ZDa09qcWtwbl9tRnJ6UjdyQmJ5azVNX1dfTy11NCIsImN1c3RvbTpncm91cHMiOiJbXCJldmVyeW9uZVwiLFwiSW50cmFuZXRXaWtpXCIsXCJTdGF0c0Rhc2hib2FyZFwiLFwiYWxsX2xkYXBfdXNlcnNcIixcImVnZW5jaWFfY2FcIixcImVnZW5jaWFfdXNcIixcIm9mZmljZV9yZW1vdGVcIixcInBob25lYm9va19hY2Nlc3NcIixcInBvY2tldF92cG5cIixcInRlYW1fbW9jb1wiLFwidGVhbV9tb2NvX2JlbmVmaXRlZFwiLFwidGVhbV9wb2NrZXRcIixcInZwbl9jb3JwXCIsXCJ2cG5fZGVmYXVsdFwiLFwibW96aWxsaWFuc29yZ19wb2NrZXRfYmFja2VuZFwiLFwibW96aWxsaWFuc29yZ19wb2NrZXRfY29sbGVjdGlvbl9jdXJhdG9yX2Z1bGxcIixcIm1vemlsbGlhbnNvcmdfcG9ja2V0X2RldmVsb3BlclwiLFwibW96aWxsaWFuc29yZ19wb2NrZXRfZmVhdHVyZWZsYWdzXCIsXCJtb3ppbGxpYW5zb3JnX3BvY2tldF9uZXdfdGFiX2N1cmF0b3JfZW5nYlwiLFwibW96aWxsaWFuc29yZ19wb2NrZXRfbmV3X3RhYl9jdXJhdG9yX2VuaW50bFwiLFwibW96aWxsaWFuc29yZ19wb2NrZXRfbmV3X3RhYl9jdXJhdG9yX2VudXNcIixcIm1vemlsbGlhbnNvcmdfcG9ja2V0X3BvY2tldF9oaXRzX2N1cmF0b3JfZGVkZVwiLFwibW96aWxsaWFuc29yZ19wb2NrZXRfcG9ja2V0X2hpdHNfY3VyYXRvcl9lbnVzXCIsXCJtb3ppbGxpYW5zb3JnX3BvY2tldF9yZWFkb25seVwiXSIsInBpY3R1cmUiOiJodHRwczpcL1wvcy5ncmF2YXRhci5jb21cL2F2YXRhclwvMTZlNjhlZTU0MjczYWM3ZWIzYmIwMDQ2ZTU4ZDAxYzE_cz00ODAmcj1wZyZkPWh0dHBzJTNBJTJGJTJGY2RuLmF1dGgwLmNvbSUyRmF2YXRhcnMlMkZobC5wbmciLCJvcmlnaW5fanRpIjoiNDZkNGNiZDgtMmU1ZC00YmNjLWFiNDctMDNlM2UxOThkNzI4IiwiYXVkIjoiNnF0OTRzOWQ2NTFrMjRtdnVsOXEybGJyY3YiLCJpZGVudGl0aWVzIjpbeyJ1c2VySWQiOiJhZHxNb3ppbGxhLUxEQVB8aGx1aGFubyIsInByb3ZpZGVyTmFtZSI6IkF1dGgwIiwicHJvdmlkZXJUeXBlIjoiT0lEQyIsImlzc3VlciI6bnVsbCwicHJpbWFyeSI6InRydWUiLCJkYXRlQ3JlYXRlZCI6IjE2NDM4MjM0MDg4MzIifV0sInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjQ3NjMxNDU0LCJuYW1lIjoiSGVycmFqIEx1aGFubyIsIm5pY2tuYW1lIjoiSGVycmFqIEx1aGFubyIsImV4cCI6MTY0NzYzNTA1NCwiaWF0IjoxNjQ3NjMxNDU0LCJmYW1pbHlfbmFtZSI6Ikx1aGFubyIsImp0aSI6ImY2ZTM5N2FkLTA2Y2YtNGM4Mi1iYmNmLTNjYmM5YjA4OWE3MyIsImVtYWlsIjoiaGx1aGFub0Btb3ppbGxhLmNvbSJ9.EwMXIItQsEJ_fnT4y4o2MTZHRM0wDxicC3uAV3v5qAmJn1du03YWPKaF4HhtBlqFA9vCvPFwbo5S57Yr29GEGN-lkZvjDdLF242YCzA0F6B_Z9c82K8BaL8GiwO2nXl5HSgaO69qwZ2Fy7PoM6_cnaXgRL1xrAzKl-NcRz0khpsJNBbErdFkm6rcSKQd_twaaIgg2zIcm-gwuBhBfO83AjjeEUdOxa9Gqrs-Z7m76ZQZZRd1W2iWB4b4BQCg_nLChGwXoejC-Dc5HlkObg4s7HoyQPaDS5OExxw-wtH41xkoJ9rudoLzmiQsnYJDsL5XBvtRor5nSRnPxFmcaS0zfw',
    },
    body: JSON.stringify({ query: mutation, variables }),
  });

  return await res.json();
}
